<!doctype html>
<html>
    <head>
        <title>Merch at Scale Studio</title>
        <meta property="og:title" content="Merch at Scale Studio" />
        <meta name="robots" content="noindex, nofollow" />
        <meta name="nofollow-links" content="on" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="aem-base-url" content=""/>
        <meta name="aem-base-url"/>
        <script>
            const baseUrl = window.location.href.includes('localhost') ? 'http://localhost:8080' : 'https://author-p22655-e155390.adobeaemcloud.com';
            document.querySelector('meta[name="aem-base-url"]')?.setAttribute('content', baseUrl);
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/7.2.1/tinymce.min.js"></script>
        <script src="studio/libs/maslib.js" type="module"></script>
        <script src="studio/libs/swc.js" type="module"></script>
        <script src="studio/libs/aem.js" type="module"></script>
        <script src="studio/libs/studio.js" type="module"></script>

        <!-- OST -->
        <script src="studio/ost/index.js"></script>
        <link rel="stylesheet" href="./studio/ost/index.css" />

        <link rel="stylesheet" href="./studio/style.css" />
        <!-- MAS Studio Icon goes here -->

        <mas-commerce-service></mas-commerce-service>

        <script>
            window.adobeid = {
                api_parameters: {
                    profile_filter:
                        "isOwnedByOrg('3B962FB55F5F922E0A495C88@AdobeOrg')",
                },
                client_id: 'mas-studio',
                environment: 'prod',
                locale: 'en_US',
                redirect_uri: location.href.substring(
                    0,
                    location.href.length - location.hash.length,
                ),
                response_type: 'id_token',
                scope: 'additional_info,additional_info.projectedProductContext,additional_info.roles,AdobeID,openid,read_organizations,read_pc,read_pc.acp,read_pc.dma_aem_ams,read_pc.dma_aem_cloud,read_pc.dma_tartan',
                useLocalStorage: true,
                authorize() {
                    const { expire, token } =
                        window.adobeIMS?.getAccessToken() ?? {};
                    if (token && (expire?.valueOf() ?? 0) > Date.now())
                        return token;
                    window.adobeIMS?.signIn();
                },
                onError(error) {
                    console.error('[M@S Studio] IMS error: ', error);
                },
                onReady() {
                    if (adobeIMS.isSignedInUser()) {
                        console.info('[M@S Studio] IMS is ready, signed in');
                    } else {
                        console.info('[M@S Studio] IMS is ready, signing in');
                        adobeIMS.signIn();
                    }
                },
            };
        </script>
        <script src="https://www.adobe.com/libs/deps/imslib.min.js"></script>
    </head>
    <body>
        <main>
            <sp-theme color="light" scale="medium">
                <script>
                    const studio = document.createElement('mas-studio');
                    studio.setAttribute('base-url', baseUrl)
                    document.querySelector('sp-theme').appendChild(studio);
                </script>
            </sp-theme>
        </main>
    </body>
</html>
